---
title: "Convergence Clubs and Regression Trees"
subtitle: "0686 - Spatial Economics"
author: "Nikolas, Philipp, Lukas & Daniel"
date: "`r format(Sys.time(), '%d %B, %Y')`"
bibliography: refs.bibtex
output: 
  beamer_presentation:
    theme: metropolis
---

```{r include=FALSE}
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})
library(stargazer)
```


## Data Recap

European Regional Database by Cambridge Econometrics

- Comprehensive dataset for NUTS2-regions over long period of time

We limit the dataset to:

- Focus on period after 2000 (possible breakpoint financial crisis 2008/9)
- Exclude Croatia (missing observations for employment indicators)

Results in a dataset of 273 regions for 28 countries

## Data Recap
\center
![](./ovw.png){width=90%}


## Oh what a merry regression tree

<!-- We try to split the observations into clubs akin to: -->
Split observations into clubs:

```{r echo=TRUE, eval=FALSE}
tree <- function(data, split_vars, end_criteria) {
  split <- find_best_split(...)
  if (!end_criteria) {
    return(list(tree(split$data1, ...),
                tree(split$data2, ...)))
  } else { # if(end_criteria)
    return(data)
  }
}
```

## Regression Tree

<!-- Thus we divide up our dataset based on some splitting variables and receive trees like this one: -->
We receive a recursive, tree-like data structure that is:

- hard to deal with (**a lot** of helper functions are necessary)
- nice

\center
<!-- Add pretty (?) tree, dummy ahead: -->
![](../pres1/tree.png){width=80%}

## Regression Tree

Our results are comparable to partykit [@hothorn15].

Still there's the caveat of spatially filtering the data.
<!-- mention fancy distance stuff -->
## Motivation
\center
![](./gdp_pc_gr.png){width=80%}


## Results
\center
![](./clubs_lm.png){width=80%}


## Results
```{r, echo=FALSE, results='asis'}
load("../../output/run.Rda")
stargazer(regs_lm, header = FALSE, font.size = "tiny", omit.stat = c("f", "rsq", "adj.rsq"),
          intercept.bottom = FALSE, title = "Regression results using unfiltered data",
          covariate.labels = c(NA, "Initial GDP p.c."), 
          dep.var.labels = "GDP p.c. growth rate 2000-15")
```


## Results
\center
![](./clubs_semsar.png){width=80%}


## Results

```{r, echo=FALSE, results='asis'}
stargazer(regs_sar, header = FALSE, font.size = "tiny", omit.stat = c("f", "rsq", "adj.rsq"),
          intercept.bottom = FALSE, title = "Regression results using SAR-filtered data",
          covariate.labels = c(NA, "Initial GDP p.c."), 
          dep.var.labels = "GDP p.c. growth rate 2000-15")
```


## Results
```{r, echo=FALSE, results='asis'}
stargazer(regs_sem, header = FALSE, font.size = "tiny", omit.stat = c("f", "rsq", "adj.rsq"),
          intercept.bottom = FALSE, title = "Regression results using SEM-filtered data",
          covariate.labels = c(NA, "Initial GDP p.c."), 
          dep.var.labels = "GDP p.c. growth rate 2000-15")
```


- club-plots
- some first LM vs. SAR vs. SEM comparisons


## Literatur
<!-- Leave me alone -->